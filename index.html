<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>WooCommerce Categories & Products</title>
<style>
  body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background: #f5f6f8; }
  h1 { text-align: center; }
  .category { margin-bottom: 30px; }
  .category h2 { background: #0073aa; color: #fff; padding: 10px; margin: 0; cursor: pointer; }
  .products { display: flex; flex-wrap: wrap; gap: 15px; padding: 10px; display: none; }
  .product { border: 1px solid #ccc; border-radius: 8px; padding: 10px; background: #fff; width: 200px; cursor: pointer; }
  .product img { max-width: 100%; border-radius: 5px; }
  .product-description { display: none; margin-top: 10px; font-size: 14px; color: #333; }
</style>
</head>
<body>
<h1>Shop Categories & Products</h1>
<div id="categories"></div>

<script>
// Replace with your WooCommerce API endpoint
const API_URL = 'https://ross.lrbcloud.co.za/wp-json/wc/v3/ams-categories';

// Fetch categories from API
async function loadCategories() {
  try {
    const res = await fetch(API_URL);
    const categories = await res.json();

    const container = document.getElementById('categories');
    container.innerHTML = '';

    categories.forEach(category => {
      const catDiv = document.createElement('div');
      catDiv.className = 'category';

      const catTitle = document.createElement('h2');
      catTitle.textContent = category.name;
      catDiv.appendChild(catTitle);

      const productsDiv = document.createElement('div');
      productsDiv.className = 'products';
      catDiv.appendChild(productsDiv);

      // Show/hide products when category clicked
      catTitle.addEventListener('click', () => {
        productsDiv.style.display = productsDiv.style.display === 'flex' ? 'none' : 'flex';
      });

      container.appendChild(catDiv);

      // Load products for this category
      loadProducts(category.id, productsDiv);
    });
  } catch (err) {
    console.error('Error loading categories:', err);
    document.getElementById('categories').innerHTML = '<p style="color:red;">Error loading categories.</p>';
  }
}

// Fetch products for a category
async function loadProducts(categoryId, container) {
  try {
    const res = await fetch(`https://ross.lrbcloud.co.za/wp-json/wc/v3/products?category=${categoryId}`);
    const products = await res.json();

    products.forEach(product => {
      const prodDiv = document.createElement('div');
      prodDiv.className = 'product';

      const img = document.createElement('img');
      img.src = product.images?.[0]?.src || '';
      prodDiv.appendChild(img);

      const name = document.createElement('div');
      name.textContent = product.name;
      name.style.fontWeight = 'bold';
      name.style.marginTop = '5px';
      prodDiv.appendChild(name);

      const desc = document.createElement('div');
      desc.className = 'product-description';
      desc.innerHTML = product.description || 'No description';
      prodDiv.appendChild(desc);

      // Toggle product description on click
      prodDiv.addEventListener('click', () => {
        desc.style.display = desc.style.display === 'block' ? 'none' : 'block';
      });

      container.appendChild(prodDiv);
    });
  } catch (err) {
    console.error('Error loading products:', err);
    container.innerHTML = '<p style="color:red;">Error loading products.</p>';
  }
}

// Load everything
loadCategories();
</script>
</body>
</html>
